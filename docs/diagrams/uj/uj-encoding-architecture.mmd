graph TB
    subgraph "JSON编码缓冲区管理"
        A1["ujbuf_t结构<br/>buf: 缓冲区指针<br/>bufsize: 总大小<br/>pos: 当前位置"]
        A2["addChar<br/>单字符添加"]
        A3["xputs<br/>字符串添加"]
        A4["xeos/xeol<br/>缓冲区边界检查"]
        A1 --> A2
        A1 --> A3
        A1 --> A4
    end
    
    subgraph "基础数据类型编码"
        B1["uj_encNull<br/>null值编码"]
        B2["uj_encBool<br/>布尔值编码"]
        B3["uj_encInt<br/>有符号整数编码"]
        B4["uj_encUint<br/>无符号整数编码"]
        B5["uj_encNum<br/>浮点数编码"]
        B6["uj_encStr<br/>字符串编码和转义"]
    end
    
    subgraph "复合结构编码"
        C1["uj_encOpen<br/>开始对象/数组"]
        C2["uj_encClose<br/>结束对象/数组"]
        C3["anotherValue<br/>值分隔符管理"]
        C4["anotherString<br/>字符串分隔符"]
        C1 --> C3
        C2 --> C3
        C3 --> C4
    end
    
    subgraph "LoRaWAN专用编码"
        D1["uj_encEui<br/>EUI-64编码"]
        D2["uj_encMac<br/>MAC地址编码"]
        D3["uj_encHex<br/>十六进制数据编码"]
        D4["uj_encTime<br/>时间戳编码"]
        D5["uj_encDate<br/>日期时间编码"]
        D6["uj_encId6<br/>6字节ID编码"]
        D7["uj_encKey<br/>密钥编码"]
    end
    
    subgraph "高级编码功能"
        E1["uj_encKV<br/>键值对编码"]
        E2["uj_encKVn<br/>多键值对编码"]
        E3["b64Encode<br/>Base64编码"]
        E4["encArg<br/>变参类型处理"]
        E1 --> E4
        E2 --> E4
        E3 --> E4
    end
    
    subgraph "扩展printf系统"
        F1["xprintf<br/>扩展格式化输出"]
        F2["vxprintf<br/>变参格式化"]
        F3["surrogate_snprintf_64bit<br/>64位数值格式化"]
        F4["padField<br/>字段填充对齐"]
        F5["hexData<br/>十六进制数据格式化"]
        F6["approxTimeSpan<br/>时间跨度近似"]
        F1 --> F2
        F2 --> F3
        F2 --> F4
        F2 --> F5
        F2 --> F6
    end
    
    subgraph "特殊格式化支持"
        G1["%J: txjob对象<br/>传输任务序列化"]
        G2["%M: MAC地址<br/>6字节MAC格式化"]
        G3["%E: EUI-64<br/>8字节EUI格式化"]
        G4["%T: 时间戳<br/>UTC时间格式化"]
        G5["%D: 日期<br/>ISO日期格式"]
        G6["%H: 十六进制<br/>原始数据格式化"]
    end
    
    A2 --> B1
    A2 --> B2
    A3 --> B6
    
    B1 --> C1
    B2 --> C1
    B3 --> C1
    B4 --> C1
    B5 --> C1
    B6 --> C1
    
    C1 --> E1
    C2 --> E1
    
    D1 --> E1
    D2 --> E1
    D3 --> E1
    D4 --> E1
    D5 --> E1
    
    E1 --> F1
    E2 --> F1
    
    F2 --> G1
    F2 --> G2
    F2 --> G3
    F2 --> G4
    F2 --> G5
    F2 --> G6
    
    style A1 fill:#e1f5fe
    style B6 fill:#e8f5e8
    style C1 fill:#fff3e0
    style D1 fill:#fce4ec
    style E1 fill:#f3e5f5
    style F1 fill:#e0f2f1
    style G1 fill:#f1f8e9 